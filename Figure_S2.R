## =================================================================================================================================================================================================================

## R code to generate Figure S2 for manuscript titled "How public reaction to disease information across scales and the impacts of vector control methods influence disease prevalence and control efficacy"

## ==================================================================================================================================================================================================================

############################################################

## K =2000 local
library(ggplot2)
library(reshape)
library(here)

## set the current directory as default to save all the following results
set_here()

cont = seq(0,200,20) # set up levels regarding the control on mosquito larvae
adultprop <- cont/max(cont)
larvaeprop <- 1 - adultprop
rep <- 30  # number of levels
N = 9 # total patch number
replic <- 50  # repeat for each control level

confidence_interval <- function(vector, interval) {
  # Standard deviation of sample
  vec_sd <- sd(vector)
  # Sample size
  n <- length(vector)
  # Mean of sample
  vec_mean <- mean(vector)
  # Error according to t distribution
  error <- qt((interval + 1)/2, df = n - 1) * vec_sd / sqrt(n)
  # Confidence interval as a vector
  result <- c("lower" = vec_mean - error, "upper" = vec_mean + error)
  return(result)
}

## read datasets generated by Matlab Code "Multi_Patch_TimeStrength.m"

##KT2000 local

setwd("~\\SF-local-N-9-p-0.01-t-1000-K=2000-time+strength+control")

KT2000localinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT2000localCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT2000locallarvaesize <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT2000localadultsize <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of control on larvae
# 
KK <- c()
for ( i in 1:dim(KT2000locallarvaesize)[1])
{
  if (KT2000locallarvaesize[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT2000locallarvaesize)[1]+1)


#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_1 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_1 <- KT2000localsizeCIhigh
ave_KT2000_local_infection_1 <- KT2000localaverageInfection
ave_KT2000_local_size_1 <- KT2000localaveragesize
x_axis_KT2000_local_1 <- x_axis_KT2000_local

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_2 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_2 <- KT2000localsizeCIhigh
ave_KT2000_local_size_2 <- KT2000localaveragesize
ave_KT2000_local_infection_2 <- KT2000localaverageInfection
x_axis_KT2000_local_2 <- x_axis_KT2000_local


########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_3 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_3 <- KT2000localsizeCIhigh
ave_KT2000_local_size_3 <- KT2000localaveragesize
ave_KT2000_local_infection_3 <- KT2000localaverageInfection
x_axis_KT2000_local_3 <- x_axis_KT2000_local

###################################################################

##level 4

###################################################################

i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_4 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_4 <- KT2000localsizeCIhigh
ave_KT2000_local_size_4 <- KT2000localaveragesize
ave_KT2000_local_infection_4 <- KT2000localaverageInfection
x_axis_KT2000_local_4 <- x_axis_KT2000_local

################################################################

## level 5

################################################################


i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_5 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_5 <- KT2000localsizeCIhigh
ave_KT2000_local_size_5 <- KT2000localaveragesize
ave_KT2000_local_infection_5 <- KT2000localaverageInfection
x_axis_KT2000_local_5 <- x_axis_KT2000_local

####################################################################

##level 6

###################################################################


i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_6 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_6 <- KT2000localsizeCIhigh
ave_KT2000_local_size_6 <- KT2000localaveragesize
ave_KT2000_local_infection_6 <- KT2000localaverageInfection
x_axis_KT2000_local_6 <- x_axis_KT2000_local

##############################################################

# ## level 7
#
# #############################################################

i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_7 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_7 <- KT2000localsizeCIhigh
ave_KT2000_local_size_7 <- KT2000localaveragesize
ave_KT2000_local_infection_7 <- KT2000localaverageInfection
x_axis_KT2000_local_7 <- x_axis_KT2000_local

# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_8 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_8 <- KT2000localsizeCIhigh
ave_KT2000_local_size_8 <- KT2000localaveragesize
ave_KT2000_local_infection_8 <- KT2000localaverageInfection
x_axis_KT2000_local_8 <- x_axis_KT2000_local

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_9 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_9 <- KT2000localsizeCIhigh
ave_KT2000_local_size_9 <- KT2000localaveragesize
ave_KT2000_local_infection_9 <- KT2000localaverageInfection
x_axis_KT2000_local_9 <- x_axis_KT2000_local

# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_10 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_10 <- KT2000localsizeCIhigh
ave_KT2000_local_size_10 <- KT2000localaveragesize
ave_KT2000_local_infection_10 <- KT2000localaverageInfection
x_axis_KT2000_local_10 <- x_axis_KT2000_local

############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000localinfect <- KT2000localinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizeadult <- KT2000localadultsize[ind[1]:(ind[length(ind)]-1), ]

KT2000localsizelarvae <- KT2000locallarvaesize[ind[1]:(ind[length(ind)]-1), ]

KT2000localCIdistancenew <- KT2000localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000localsizeadult)[1])
{
  if (KT2000localsizeadult[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000localsizeadult)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000localmeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_local <- KT2000localsizeadult[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_local <-KT2000localsizeadult[KK[rep]:dim(KT2000localsizeadult)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000localdataset0 <- KT2000localinfect[KK[i]:(KK[i+1]-1),]
  KT2000localdataset1 <- KT2000localsizelarvae[KK[i]:(KK[i+1]-1),]
  KT2000localdataset2 <- KT2000localsizeadult[KK[i]:(KK[i+1]-1),]
  KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[i,])+1)]
  KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
  KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
  KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y
  
  KT2000localmeansizetotal[i,]<-KT2000localmeanInfectionSum
  KT2000localmeansizetotal[i,]<-KT2000localmeansizesum1
}

KT2000localdataset0 <- KT2000localinfect[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset1 <- KT2000localsizelarvae[KK[rep]:attributes(as.matrix(KT2000localsizelarvae))$dim[1],]
KT2000localdataset2 <- KT2000localsizeadult[KK[rep]:attributes(as.matrix(KT2000localsizeadult))$dim[1],]
KT2000localdata0 <- KT2000localdataset0[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize1 <- KT2000localdataset1[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 

KT2000localdataSize2 <- KT2000localdataset2[,-(which.min(KT2000localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000localmeanInfectionSum <- as.vector(rowSums(KT2000localdata0[,2:ncol(KT2000localdata0)])/(N-1))
KT2000localmeansizesum <- as.vector(rowSums(1*KT2000localdataSize1[,2:ncol(KT2000localdataSize1)]+1*KT2000localdataSize2[,2:ncol(KT2000localdataSize2)])/(N-1))
KT2000localmeansizesum1<-approx(KT2000localdataSize1[,1],KT2000localmeansizesum, x_axis_KT2000_local)$y

KT2000localmeansizetotal[rep,]<-KT2000localmeanInfectionSum
KT2000localmeansizetotal[rep,]<-KT2000localmeansizesum1

KT2000localaverageInfection <- colSums(KT2000localmeansizetotal)/rep

KT2000localaveragesize<- colSums(KT2000localmeansizetotal)/rep

KT2000localsizeCIlow<-c()
KT2000localsizeCIhigh<-c()

for(i in 1:length(KT2000localaveragesize))
{
  KT2000localsizeCIlow[i]<-confidence_interval(KT2000localmeansizetotal[,i], 0.95)[1][[1]]
  KT2000localsizeCIhigh[i]<-confidence_interval(KT2000localmeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_local_size_11 <- KT2000localsizeCIlow
CI_high_KT2000_local_size_11 <- KT2000localsizeCIhigh
ave_KT2000_local_size_11 <- KT2000localaveragesize
ave_KT2000_local_infection_11 <- KT2000localaverageInfection
x_axis_KT2000_local_11 <- x_axis_KT2000_local

###################################################################################################################################

setwd("~\\SF-neighbor-N-9-p-0.01-t-1000-K=2000-time+strength+control")

KT2000neighborinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT2000neighborCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT2000neighborsizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT2000neighborsizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of size on larvae
# 
KK <- c()
for ( i in 1:dim(KT2000neighborsizelarvae)[1])
{
  if (KT2000neighborsizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT2000neighborsizelarvae)[1]+1)

#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_1 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_1 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_1<- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_1 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_1 <- x_axis_KT2000_neighbor

#####

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_2 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_2 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_2 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_2 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_2 <- x_axis_KT2000_neighbor

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_3 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_3 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_3 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_3 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_3 <- x_axis_KT2000_neighbor

###################################################################

##level 4

###################################################################


i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_4 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_4 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_4 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_4 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_4 <- x_axis_KT2000_neighbor

################################################################

## level 5

################################################################


i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_5 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_5 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_5 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_5 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_5 <- x_axis_KT2000_neighbor

####################################################################

##level 6

###################################################################


i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_6 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_6 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_6 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_6 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_6 <- x_axis_KT2000_neighbor

##############################################################

# ## level 7
#
# #############################################################


i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_7 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_7 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_7 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_7 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_7 <- x_axis_KT2000_neighbor

# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_8 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_8 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_8 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_8 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_8 <- x_axis_KT2000_neighbor

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_9 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_9 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_9 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_9 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_9 <- x_axis_KT2000_neighbor

# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_10 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_10 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_10 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_10 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_10 <- x_axis_KT2000_neighbor

############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000neighborinfect <- KT2000neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000neighboradultsize <- KT2000neighborsizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborlarvaesize <- KT2000neighborsizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000neighborCIdistancenew <- KT2000neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000neighboradultsize)[1])
{
  if (KT2000neighboradultsize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000neighboradultsize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000neighbormeansizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_neighbor <- KT2000neighboradultsize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_neighbor <-KT2000neighboradultsize[KK[rep]:dim(KT2000neighboradultsize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000neighbordataset0 <- KT2000neighborinfect[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordataset2 <- KT2000neighboradultsize[KK[i]:(KK[i+1]-1),]
  KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[i,])+1)]
  KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
  KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
  KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y
  
  KT2000neighbormeanInfectiontotal[i,]<-KT2000neighbormeanInfectionSum
  KT2000neighbormeansizetotal[i,]<-KT2000neighbormeansizesum1
}

##last row of KT2000neighbormeanadultsize
KT2000neighbordataset0 <- KT2000neighborinfect[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset1 <- KT2000neighborlarvaesize[KK[rep]:attributes(as.matrix(KT2000neighborlarvaesize))$dim[1],]
KT2000neighbordataset2 <- KT2000neighboradultsize[KK[rep]:attributes(as.matrix(KT2000neighboradultsize))$dim[1],]
KT2000neighbordata0 <- KT2000neighbordataset0[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize1 <- KT2000neighbordataset1[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 

KT2000neighbordatasize2 <- KT2000neighbordataset2[,-(which.min(KT2000neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000neighbormeanInfectionSum <- as.vector(rowSums(KT2000neighbordata0[,2:ncol(KT2000neighbordata0)])/(N-1))
KT2000neighbormeansizesum <- as.vector(rowSums(1*KT2000neighbordatasize1[,2:ncol(KT2000neighbordatasize1)]+1*KT2000neighbordatasize2[,2:ncol(KT2000neighbordatasize2)])/(N-1))
KT2000neighbormeansizesum1<-approx(KT2000neighbordatasize1[,1],KT2000neighbormeansizesum, x_axis_KT2000_neighbor)$y

KT2000neighbormeanInfectiontotal[rep,]<-KT2000neighbormeanInfectionSum
KT2000neighbormeansizetotal[rep,]<-KT2000neighbormeansizesum1

KT2000neighboraverageInfection <- colSums(KT2000neighbormeanInfectiontotal)/rep

KT2000neighboraveragesize <- colSums(KT2000neighbormeansizetotal)/rep

KT2000neighborsizeCIlow<-c()
KT2000neighborsizeCIhigh<-c()

for(i in 1:length(KT2000neighboraveragesize))
{
  KT2000neighborsizeCIlow[i]<-confidence_interval(KT2000neighbormeansizetotal[,i], 0.95)[1][[1]]
  KT2000neighborsizeCIhigh[i]<-confidence_interval(KT2000neighbormeansizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_neighbor_size_11 <- KT2000neighborsizeCIlow
CI_high_KT2000_neighbor_size_11 <- KT2000neighborsizeCIhigh
ave_KT2000_neighbor_size_11 <- KT2000neighboraveragesize
ave_KT2000_neighbor_infection_11 <- KT2000neighboraverageInfection
x_axis_KT2000_neighbor_11 <- x_axis_KT2000_neighbor

########################################################################################################################

setwd("~\\SF-global-N-9-p-0.01-t-1000-K=2000-time+strength+control")

KT2000globalinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT2000globalCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT2000globalSizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT2000globalSizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of Size on larvae
# 
KK <- c()
for ( i in 1:dim(KT2000globalSizelarvae)[1])
{
  if (KT2000globalSizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT2000globalSizelarvae)[1]+1)
# 
#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_1 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_1 <- KT2000globalSizeCIhigh
ave_KT2000_global_infection_1 <- KT2000globalaverageInfection
ave_KT2000_global_size_1 <- KT2000globalaverageSize
x_axis_KT2000_global_1 <- x_axis_KT2000_global

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_2 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_2 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_2 <- KT2000globalaverageSize
ave_KT2000_global_infection_2 <- KT2000globalaverageInfection
x_axis_KT2000_global_2 <- x_axis_KT2000_global

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_3 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_3 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_3 <- KT2000globalaverageSize
ave_KT2000_global_infection_3 <- KT2000globalaverageInfection
x_axis_KT2000_global_3 <- x_axis_KT2000_global

###################################################################

##level 4

###################################################################

i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_4 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_4 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_4 <- KT2000globalaverageSize
ave_KT2000_global_infection_4 <- KT2000globalaverageInfection
x_axis_KT2000_global_4 <- x_axis_KT2000_global

################################################################

## level 5

################################################################

i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_5 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_5 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_5 <- KT2000globalaverageSize
ave_KT2000_global_infection_5 <- KT2000globalaverageInfection
x_axis_KT2000_global_5 <- x_axis_KT2000_global

####################################################################

##level 6

###################################################################

i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_6 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_6 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_6 <- KT2000globalaverageSize
ave_KT2000_global_infection_6 <- KT2000globalaverageInfection
x_axis_KT2000_global_6 <- x_axis_KT2000_global

##############################################################

# ## level 7
#
# #############################################################

i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_7 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_7 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_7 <- KT2000globalaverageSize
ave_KT2000_global_infection_7 <- KT2000globalaverageInfection
x_axis_KT2000_global_7 <- x_axis_KT2000_global

# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_8 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_8 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_8 <- KT2000globalaverageSize
ave_KT2000_global_infection_8 <- KT2000globalaverageInfection
x_axis_KT2000_global_8 <- x_axis_KT2000_global

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_9 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_9 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_9 <- KT2000globalaverageSize
ave_KT2000_global_infection_9 <- KT2000globalaverageInfection
x_axis_KT2000_global_9 <- x_axis_KT2000_global

# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_10 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_10 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_10 <- KT2000globalaverageSize
ave_KT2000_global_infection_10 <- KT2000globalaverageInfection
x_axis_KT2000_global_10 <- x_axis_KT2000_global

############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT2000globalinfect <- KT2000globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT2000globaladultSize <- KT2000globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT2000globallarvaeSize <- KT2000globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT2000globalCIdistancenew <- KT2000globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT2000globaladultSize)[1])
{
  if (KT2000globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT2000globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT2000globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT2000globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT2000_global <- KT2000globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT2000_global <-KT2000globaladultSize[KK[rep]:dim(KT2000globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT2000globaldataset0 <- KT2000globalinfect[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset1 <- KT2000globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldataset2 <- KT2000globaladultSize[KK[i]:(KK[i+1]-1),]
  KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[i,])+1)]
  KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
  KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
  KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y
  
  KT2000globalmeanInfectiontotal[i,]<-KT2000globalmeanInfectionSum
  KT2000globalmeanSizetotal[i,]<-KT2000globalmeanSizesum1
}

##last row of KT2000globalmeanadultSize
KT2000globaldataset0 <- KT2000globalinfect[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset1 <- KT2000globallarvaeSize[KK[rep]:attributes(as.matrix(KT2000globallarvaeSize))$dim[1],]
KT2000globaldataset2 <- KT2000globaladultSize[KK[rep]:attributes(as.matrix(KT2000globaladultSize))$dim[1],]
KT2000globaldata0 <- KT2000globaldataset0[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize1 <- KT2000globaldataset1[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 

KT2000globaldataSize2 <- KT2000globaldataset2[,-(which.min(KT2000globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT2000globalmeanInfectionSum <- as.vector(rowSums(KT2000globaldata0[,2:ncol(KT2000globaldata0)])/(N-1))
KT2000globalmeanSizesum <- as.vector(rowSums(1*KT2000globaldataSize1[,2:ncol(KT2000globaldataSize1)]+1*KT2000globaldataSize2[,2:ncol(KT2000globaldataSize2)])/(N-1))
KT2000globalmeanSizesum1<-approx(KT2000globaldataSize1[,1],KT2000globalmeanSizesum, x_axis_KT2000_global)$y

KT2000globalmeanInfectiontotal[rep,]<-KT2000globalmeanInfectionSum
KT2000globalmeanSizetotal[rep,]<-KT2000globalmeanSizesum1

KT2000globalaverageInfection <- colSums(KT2000globalmeanInfectiontotal)/rep

KT2000globalaverageSize <- colSums(KT2000globalmeanSizetotal)/rep

KT2000globalSizeCIlow<-c()
KT2000globalSizeCIhigh<-c()

for(i in 1:length(KT2000globalaverageSize))
{
  KT2000globalSizeCIlow[i]<-confidence_interval(KT2000globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT2000globalSizeCIhigh[i]<-confidence_interval(KT2000globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT2000_global_size_11 <- KT2000globalSizeCIlow
CI_high_KT2000_global_size_11 <- KT2000globalSizeCIhigh
ave_KT2000_global_size_11 <- KT2000globalaverageSize
ave_KT2000_global_infection_11 <- KT2000globalaverageInfection
x_axis_KT2000_global_11 <- x_axis_KT2000_global

############################
setwd("~\\SF-local-N-9-p-0.01-t-1000-K=800-time+strength+control")

KT800localinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT800localCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT800localSizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT800localSizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of Size on larvae
# 
KK <- c()
for ( i in 1:dim(KT800localSizelarvae)[1])
{
  if (KT800localSizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT800localSizelarvae)[1]+1)

#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_1 <- KT800localSizeCIlow
CI_high_KT800_local_Size_1 <- KT800localSizeCIhigh
ave_KT800_local_infection_1 <- KT800localaverageInfection
ave_KT800_local_Size_1 <- KT800localaverageSize
x_axis_KT800_local_1 <- x_axis_KT800_local

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_2 <- KT800localSizeCIlow
CI_high_KT800_local_Size_2 <- KT800localSizeCIhigh
ave_KT800_local_Size_2 <- KT800localaverageSize
ave_KT800_local_infection_2 <- KT800localaverageInfection
x_axis_KT800_local_2 <- x_axis_KT800_local

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_3 <- KT800localSizeCIlow
CI_high_KT800_local_Size_3 <- KT800localSizeCIhigh
ave_KT800_local_Size_3 <- KT800localaverageSize
ave_KT800_local_infection_3 <- KT800localaverageInfection
x_axis_KT800_local_3 <- x_axis_KT800_local

###################################################################

##level 4

###################################################################


i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_4 <- KT800localSizeCIlow
CI_high_KT800_local_Size_4 <- KT800localSizeCIhigh
ave_KT800_local_Size_4 <- KT800localaverageSize
ave_KT800_local_infection_4 <- KT800localaverageInfection
x_axis_KT800_local_4 <- x_axis_KT800_local

################################################################

## level 5

################################################################


i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_5 <- KT800localSizeCIlow
CI_high_KT800_local_Size_5 <- KT800localSizeCIhigh
ave_KT800_local_Size_5 <- KT800localaverageSize
ave_KT800_local_infection_5 <- KT800localaverageInfection
x_axis_KT800_local_5 <- x_axis_KT800_local

####################################################################

##level 6

###################################################################


i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_6 <- KT800localSizeCIlow
CI_high_KT800_local_Size_6 <- KT800localSizeCIhigh
ave_KT800_local_Size_6 <- KT800localaverageSize
ave_KT800_local_infection_6 <- KT800localaverageInfection
x_axis_KT800_local_6 <- x_axis_KT800_local

##############################################################

# ## level 7
#
# #############################################################


i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
  # KT800localdatasetadultSize <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  # KT800localdataadultSize <-  KT800localdatasetadultSize[,-(which.min(KT800localCIdistancenew[i,])+1)]  ##this 1 is the time column
  # KT800localmeanadultSize1 <- as.vector(rowSums( KT800localdataadultSize[,2:N])/(N-1))
  # KT800localmeanadultSize2<-approx( KT800localdatasetadultSize[,1],KT800localmeanadultSize1, x_axis_KT800local)$y
  # 
  # KT800localmeanadultSizetotal[i,]<-KT800localmeanadultSize2
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_7 <- KT800localSizeCIlow
CI_high_KT800_local_Size_7 <- KT800localSizeCIhigh
ave_KT800_local_Size_7 <- KT800localaverageSize
ave_KT800_local_infection_7 <- KT800localaverageInfection
x_axis_KT800_local_7 <- x_axis_KT800_local

# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_8 <- KT800localSizeCIlow
CI_high_KT800_local_Size_8 <- KT800localSizeCIhigh
ave_KT800_local_Size_8 <- KT800localaverageSize
ave_KT800_local_infection_8 <- KT800localaverageInfection
x_axis_KT800_local_8 <- x_axis_KT800_local

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_9 <- KT800localSizeCIlow
CI_high_KT800_local_Size_9 <- KT800localSizeCIhigh
ave_KT800_local_Size_9 <- KT800localaverageSize
ave_KT800_local_infection_9 <- KT800localaverageInfection
x_axis_KT800_local_9 <- x_axis_KT800_local

# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_10 <- KT800localSizeCIlow
CI_high_KT800_local_Size_10 <- KT800localSizeCIhigh
ave_KT800_local_Size_10 <- KT800localaverageSize
ave_KT800_local_infection_10 <- KT800localaverageInfection
x_axis_KT800_local_10 <- x_axis_KT800_local

############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800localinfect <- KT800localinfection[ind[1]:(ind[length(ind)]-1), ]

KT800localadultSize <- KT800localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800locallarvaeSize <- KT800localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800localCIdistancenew <- KT800localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800localadultSize)[1])
{
  if (KT800localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_local <- KT800localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_local <-KT800localadultSize[KK[rep]:dim(KT800localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800localdataset0 <- KT800localinfect[KK[i]:(KK[i+1]-1),]
  KT800localdataset1 <- KT800locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800localdataset2 <- KT800localadultSize[KK[i]:(KK[i+1]-1),]
  KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[i,])+1)]
  KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
  KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
  KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y
  
  KT800localmeanInfectiontotal[i,]<-KT800localmeanInfectionSum
  KT800localmeanSizetotal[i,]<-KT800localmeanSizesum1
}

##last row of KT800localmeanadultSize
KT800localdataset0 <- KT800localinfect[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset1 <- KT800locallarvaeSize[KK[rep]:attributes(as.matrix(KT800locallarvaeSize))$dim[1],]
KT800localdataset2 <- KT800localadultSize[KK[rep]:attributes(as.matrix(KT800localadultSize))$dim[1],]
KT800localdata0 <- KT800localdataset0[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize1 <- KT800localdataset1[,-(which.min(KT800localCIdistancenew[rep,])+1)] 

KT800localdataSize2 <- KT800localdataset2[,-(which.min(KT800localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800localmeanInfectionSum <- as.vector(rowSums(KT800localdata0[,2:ncol(KT800localdata0)])/(N-1))
KT800localmeanSizesum <- as.vector(rowSums(1*KT800localdataSize1[,2:ncol(KT800localdataSize1)]+1*KT800localdataSize2[,2:ncol(KT800localdataSize2)])/(N-1))
KT800localmeanSizesum1<-approx(KT800localdataSize1[,1],KT800localmeanSizesum, x_axis_KT800_local)$y

KT800localmeanInfectiontotal[rep,]<-KT800localmeanInfectionSum
KT800localmeanSizetotal[rep,]<-KT800localmeanSizesum1

KT800localaverageInfection <- colSums(KT800localmeanInfectiontotal)/rep

KT800localaverageSize <- colSums(KT800localmeanSizetotal)/rep

KT800localSizeCIlow<-c()
KT800localSizeCIhigh<-c()

for(i in 1:length(KT800localaverageSize))
{
  KT800localSizeCIlow[i]<-confidence_interval(KT800localmeanSizetotal[,i], 0.95)[1][[1]]
  KT800localSizeCIhigh[i]<-confidence_interval(KT800localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_local_Size_11 <- KT800localSizeCIlow
CI_high_KT800_local_Size_11 <- KT800localSizeCIhigh
ave_KT800_local_Size_11 <- KT800localaverageSize
ave_KT800_local_infection_11 <- KT800localaverageInfection
x_axis_KT800_local_11 <- x_axis_KT800_local

################################################################################################################################
setwd("~\\SF-neighbor-N-9-p-0.01-t-1000-K=800-time+strength+control")

KT800neighborinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT800neighborCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT800neighborSizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT800neighborSizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of Size on larvae
# 
KK <- c()
for ( i in 1:dim(KT800neighborSizelarvae)[1])
{
  if (KT800neighborSizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT800neighborSizelarvae)[1]+1)

#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1

}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_1 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_1 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_infection_1 <- KT800neighboraverageInfection
ave_KT800_neighbor_Size_1 <- KT800neighboraverageSize
x_axis_KT800_neighbor_1 <- x_axis_KT800_neighbor

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_2 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_2 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_2 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_2 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_2 <- x_axis_KT800_neighbor

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_3 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_3 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_3 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_3 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_3 <- x_axis_KT800_neighbor

###################################################################

##level 4

###################################################################

i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_4 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_4 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_4 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_4 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_4 <- x_axis_KT800_neighbor

################################################################

## level 5

################################################################

i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_5 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_5 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_5 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_5 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_5 <- x_axis_KT800_neighbor

####################################################################

##level 6

###################################################################

i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_6 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_6 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_6 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_6 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_6 <- x_axis_KT800_neighbor

##############################################################

# ## level 7
#
# #############################################################

i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_7 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_7 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_7 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_7 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_7 <- x_axis_KT800_neighbor

# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_8 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_8 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_8 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_8 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_8 <- x_axis_KT800_neighbor

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_9 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_9 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_9 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_9 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_9 <- x_axis_KT800_neighbor

# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_10 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_10 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_10 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_10 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_10 <- x_axis_KT800_neighbor

############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800neighborinfect <- KT800neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT800neighboradultSize <- KT800neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800neighborlarvaeSize <- KT800neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800neighborCIdistancenew <- KT800neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800neighboradultSize)[1])
{
  if (KT800neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_neighbor <- KT800neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_neighbor <-KT800neighboradultSize[KK[rep]:dim(KT800neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800neighbordataset0 <- KT800neighborinfect[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordataset2 <- KT800neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[i,])+1)]
  KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
  KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
  KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y
  
  KT800neighbormeanInfectiontotal[i,]<-KT800neighbormeanInfectionSum
  KT800neighbormeanSizetotal[i,]<-KT800neighbormeanSizesum1
}

##last row of KT800neighbormeanadultSize
KT800neighbordataset0 <- KT800neighborinfect[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset1 <- KT800neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT800neighborlarvaeSize))$dim[1],]
KT800neighbordataset2 <- KT800neighboradultSize[KK[rep]:attributes(as.matrix(KT800neighboradultSize))$dim[1],]
KT800neighbordata0 <- KT800neighbordataset0[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize1 <- KT800neighbordataset1[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 

KT800neighbordataSize2 <- KT800neighbordataset2[,-(which.min(KT800neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800neighbormeanInfectionSum <- as.vector(rowSums(KT800neighbordata0[,2:ncol(KT800neighbordata0)])/(N-1))
KT800neighbormeanSizesum <- as.vector(rowSums(1*KT800neighbordataSize1[,2:ncol(KT800neighbordataSize1)]+1*KT800neighbordataSize2[,2:ncol(KT800neighbordataSize2)])/(N-1))
KT800neighbormeanSizesum1<-approx(KT800neighbordataSize1[,1],KT800neighbormeanSizesum, x_axis_KT800_neighbor)$y

KT800neighbormeanInfectiontotal[rep,]<-KT800neighbormeanInfectionSum
KT800neighbormeanSizetotal[rep,]<-KT800neighbormeanSizesum1

KT800neighboraverageInfection <- colSums(KT800neighbormeanInfectiontotal)/rep

KT800neighboraverageSize <- colSums(KT800neighbormeanSizetotal)/rep

KT800neighborSizeCIlow<-c()
KT800neighborSizeCIhigh<-c()

for(i in 1:length(KT800neighboraverageSize))
{
  KT800neighborSizeCIlow[i]<-confidence_interval(KT800neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT800neighborSizeCIhigh[i]<-confidence_interval(KT800neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_neighbor_Size_11 <- KT800neighborSizeCIlow
CI_high_KT800_neighbor_Size_11 <- KT800neighborSizeCIhigh
ave_KT800_neighbor_Size_11 <- KT800neighboraverageSize
ave_KT800_neighbor_infection_11 <- KT800neighboraverageInfection
x_axis_KT800_neighbor_11 <- x_axis_KT800_neighbor

##############################################################################################################################
## read datasets generated by Matlab

setwd("~\\SF-global-N-9-p-0.01-t-1000-K=800-time+strength+control")

KT800globalinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT800globalCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT800globalSizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT800globalSizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)

#############################################################

# group all orginal datasets according to the levels of Size on larvae
# 
KK <- c()
for ( i in 1:dim(KT800globalSizelarvae)[1])
{
  if (KT800globalSizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT800globalSizelarvae)[1]+1)

#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_1 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_1 <- KT800globalSizeCIhigh
ave_KT800_global_infection_1 <- KT800globalaverageInfection
ave_KT800_global_Size_1 <- KT800globalaverageSize
x_axis_KT800_global_1 <- x_axis_KT800_global

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_2 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_2 <- KT800globalSizeCIhigh
ave_KT800_global_Size_2 <- KT800globalaverageSize
ave_KT800_global_infection_2 <- KT800globalaverageInfection
x_axis_KT800_global_2 <- x_axis_KT800_global

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_3 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_3 <- KT800globalSizeCIhigh
ave_KT800_global_Size_3 <- KT800globalaverageSize
ave_KT800_global_infection_3 <- KT800globalaverageInfection
x_axis_KT800_global_3 <- x_axis_KT800_global

###################################################################

##level 4

###################################################################

i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1

}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_4 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_4 <- KT800globalSizeCIhigh
ave_KT800_global_Size_4 <- KT800globalaverageSize
ave_KT800_global_infection_4 <- KT800globalaverageInfection
x_axis_KT800_global_4 <- x_axis_KT800_global
#

################################################################

## level 5

################################################################


i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1

}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_5 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_5 <- KT800globalSizeCIhigh
ave_KT800_global_Size_5 <- KT800globalaverageSize
ave_KT800_global_infection_5 <- KT800globalaverageInfection
x_axis_KT800_global_5 <- x_axis_KT800_global
#
####################################################################

##level 6

###################################################################


i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1

}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_6 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_6 <- KT800globalSizeCIhigh
ave_KT800_global_Size_6 <- KT800globalaverageSize
ave_KT800_global_infection_6 <- KT800globalaverageInfection
x_axis_KT800_global_6 <- x_axis_KT800_global

##############################################################

# ## level 7
#
# #############################################################


i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_7 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_7 <- KT800globalSizeCIhigh
ave_KT800_global_Size_7 <- KT800globalaverageSize
ave_KT800_global_infection_7 <- KT800globalaverageInfection
x_axis_KT800_global_7 <- x_axis_KT800_global

# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_8 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_8 <- KT800globalSizeCIhigh
ave_KT800_global_Size_8 <- KT800globalaverageSize
ave_KT800_global_infection_8 <- KT800globalaverageInfection
x_axis_KT800_global_8 <- x_axis_KT800_global

# ############################################################
#
# ##level 9
#
# ############################################################


i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_9 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_9 <- KT800globalSizeCIhigh
ave_KT800_global_Size_9 <- KT800globalaverageSize
ave_KT800_global_infection_9 <- KT800globalaverageInfection
x_axis_KT800_global_9 <- x_axis_KT800_global

# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_10 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_10 <- KT800globalSizeCIhigh
ave_KT800_global_Size_10 <- KT800globalaverageSize
ave_KT800_global_infection_10 <- KT800globalaverageInfection
x_axis_KT800_global_10 <- x_axis_KT800_global


############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT800globalinfect <- KT800globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT800globaladultSize <- KT800globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT800globallarvaeSize <- KT800globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT800globalCIdistancenew <- KT800globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT800globaladultSize)[1])
{
  if (KT800globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT800globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT800globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT800globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT800_global <- KT800globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT800_global <-KT800globaladultSize[KK[rep]:dim(KT800globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT800globaldataset0 <- KT800globalinfect[KK[i]:(KK[i+1]-1),]
  KT800globaldataset1 <- KT800globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT800globaldataset2 <- KT800globaladultSize[KK[i]:(KK[i+1]-1),]
  KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[i,])+1)]
  KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
  KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
  KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y
  
  KT800globalmeanInfectiontotal[i,]<-KT800globalmeanInfectionSum
  KT800globalmeanSizetotal[i,]<-KT800globalmeanSizesum1
}

##last row of KT800globalmeanadultSize
KT800globaldataset0 <- KT800globalinfect[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset1 <- KT800globallarvaeSize[KK[rep]:attributes(as.matrix(KT800globallarvaeSize))$dim[1],]
KT800globaldataset2 <- KT800globaladultSize[KK[rep]:attributes(as.matrix(KT800globaladultSize))$dim[1],]
KT800globaldata0 <- KT800globaldataset0[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize1 <- KT800globaldataset1[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 

KT800globaldataSize2 <- KT800globaldataset2[,-(which.min(KT800globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT800globalmeanInfectionSum <- as.vector(rowSums(KT800globaldata0[,2:ncol(KT800globaldata0)])/(N-1))
KT800globalmeanSizesum <- as.vector(rowSums(1*KT800globaldataSize1[,2:ncol(KT800globaldataSize1)]+1*KT800globaldataSize2[,2:ncol(KT800globaldataSize2)])/(N-1))
KT800globalmeanSizesum1<-approx(KT800globaldataSize1[,1],KT800globalmeanSizesum, x_axis_KT800_global)$y

KT800globalmeanInfectiontotal[rep,]<-KT800globalmeanInfectionSum
KT800globalmeanSizetotal[rep,]<-KT800globalmeanSizesum1

KT800globalaverageInfection <- colSums(KT800globalmeanInfectiontotal)/rep

KT800globalaverageSize <- colSums(KT800globalmeanSizetotal)/rep

KT800globalSizeCIlow<-c()
KT800globalSizeCIhigh<-c()

for(i in 1:length(KT800globalaverageSize))
{
  KT800globalSizeCIlow[i]<-confidence_interval(KT800globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT800globalSizeCIhigh[i]<-confidence_interval(KT800globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT800_global_Size_11 <- KT800globalSizeCIlow
CI_high_KT800_global_Size_11 <- KT800globalSizeCIhigh
ave_KT800_global_Size_11 <- KT800globalaverageSize
ave_KT800_global_infection_11 <- KT800globalaverageInfection
x_axis_KT800_global_11 <- x_axis_KT800_global

#############################################################################################################################
setwd("~\\SF-local-N-9-p-0.01-t-1000-K=500-time+strength+control")

KT500localinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT500localCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT500localSizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT500localSizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of Size on larvae
# 
KK <- c()
for ( i in 1:dim(KT500localSizelarvae)[1])
{
  if (KT500localSizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT500localSizelarvae)[1]+1)
# 

#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1

}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_1 <- KT500localSizeCIlow
CI_high_KT500_local_Size_1 <- KT500localSizeCIhigh
ave_KT500_local_infection_1 <- KT500localaverageInfection
ave_KT500_local_Size_1 <- KT500localaverageSize
x_axis_KT500_local_1 <- x_axis_KT500_local
### test plots




#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1
 
}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_2 <- KT500localSizeCIlow
CI_high_KT500_local_Size_2 <- KT500localSizeCIhigh
ave_KT500_local_Size_2 <- KT500localaverageSize
ave_KT500_local_infection_2 <- KT500localaverageInfection
x_axis_KT500_local_2 <- x_axis_KT500_local

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1

}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_3 <- KT500localSizeCIlow
CI_high_KT500_local_Size_3 <- KT500localSizeCIhigh
ave_KT500_local_Size_3 <- KT500localaverageSize
ave_KT500_local_infection_3 <- KT500localaverageInfection
x_axis_KT500_local_3 <- x_axis_KT500_local


###################################################################

##level 4

###################################################################


i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1
 
}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_4 <- KT500localSizeCIlow
CI_high_KT500_local_Size_4 <- KT500localSizeCIhigh
ave_KT500_local_Size_4 <- KT500localaverageSize
ave_KT500_local_infection_4 <- KT500localaverageInfection
x_axis_KT500_local_4 <- x_axis_KT500_local

################################################################

## level 5

################################################################


i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1
 
}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_5 <- KT500localSizeCIlow
CI_high_KT500_local_Size_5 <- KT500localSizeCIhigh
ave_KT500_local_Size_5 <- KT500localaverageSize
ave_KT500_local_infection_5 <- KT500localaverageInfection
x_axis_KT500_local_5 <- x_axis_KT500_local

####################################################################

##level 6

###################################################################


i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1

}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_6 <- KT500localSizeCIlow
CI_high_KT500_local_Size_6 <- KT500localSizeCIhigh
ave_KT500_local_Size_6 <- KT500localaverageSize
ave_KT500_local_infection_6 <- KT500localaverageInfection
x_axis_KT500_local_6 <- x_axis_KT500_local

##############################################################

# ## level 7
#
# #############################################################


i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1

}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_7 <- KT500localSizeCIlow
CI_high_KT500_local_Size_7 <- KT500localSizeCIhigh
ave_KT500_local_Size_7 <- KT500localaverageSize
ave_KT500_local_infection_7 <- KT500localaverageInfection
x_axis_KT500_local_7 <- x_axis_KT500_local


# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1
}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_8 <- KT500localSizeCIlow
CI_high_KT500_local_Size_8 <- KT500localSizeCIhigh
ave_KT500_local_Size_8 <- KT500localaverageSize
ave_KT500_local_infection_8 <- KT500localaverageInfection
x_axis_KT500_local_8 <- x_axis_KT500_local

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1
 
}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_9 <- KT500localSizeCIlow
CI_high_KT500_local_Size_9 <- KT500localSizeCIhigh
ave_KT500_local_Size_9 <- KT500localaverageSize
ave_KT500_local_infection_9 <- KT500localaverageInfection
x_axis_KT500_local_9 <- x_axis_KT500_local


# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1

}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_10 <- KT500localSizeCIlow
CI_high_KT500_local_Size_10 <- KT500localSizeCIhigh
ave_KT500_local_Size_10 <- KT500localaverageSize
ave_KT500_local_infection_10 <- KT500localaverageInfection
x_axis_KT500_local_10 <- x_axis_KT500_local


############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500localinfect <- KT500localinfection[ind[1]:(ind[length(ind)]-1), ]

KT500localadultSize <- KT500localSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500locallarvaeSize <- KT500localSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500localCIdistancenew <- KT500localCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500localadultSize)[1])
{
  if (KT500localadultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500localadultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500localmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500localmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_local <- KT500localadultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_local <-KT500localadultSize[KK[rep]:dim(KT500localadultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500localdataset0 <- KT500localinfect[KK[i]:(KK[i+1]-1),]
  KT500localdataset1 <- KT500locallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500localdataset2 <- KT500localadultSize[KK[i]:(KK[i+1]-1),]
  KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[i,])+1)]
  KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
  KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
  KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y
  
  KT500localmeanInfectiontotal[i,]<-KT500localmeanInfectionSum
  KT500localmeanSizetotal[i,]<-KT500localmeanSizesum1

}

##last row of KT500localmeanadultSize
KT500localdataset0 <- KT500localinfect[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset1 <- KT500locallarvaeSize[KK[rep]:attributes(as.matrix(KT500locallarvaeSize))$dim[1],]
KT500localdataset2 <- KT500localadultSize[KK[rep]:attributes(as.matrix(KT500localadultSize))$dim[1],]
KT500localdata0 <- KT500localdataset0[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize1 <- KT500localdataset1[,-(which.min(KT500localCIdistancenew[rep,])+1)] 

KT500localdataSize2 <- KT500localdataset2[,-(which.min(KT500localCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500localmeanInfectionSum <- as.vector(rowSums(KT500localdata0[,2:ncol(KT500localdata0)])/(N-1))
KT500localmeanSizesum <- as.vector(rowSums(1*KT500localdataSize1[,2:ncol(KT500localdataSize1)]+1*KT500localdataSize2[,2:ncol(KT500localdataSize2)])/(N-1))
KT500localmeanSizesum1<-approx(KT500localdataSize1[,1],KT500localmeanSizesum, x_axis_KT500_local)$y

KT500localmeanInfectiontotal[rep,]<-KT500localmeanInfectionSum
KT500localmeanSizetotal[rep,]<-KT500localmeanSizesum1

KT500localaverageInfection <- colSums(KT500localmeanInfectiontotal)/rep

KT500localaverageSize <- colSums(KT500localmeanSizetotal)/rep

KT500localSizeCIlow<-c()
KT500localSizeCIhigh<-c()

for(i in 1:length(KT500localaverageSize))
{
  KT500localSizeCIlow[i]<-confidence_interval(KT500localmeanSizetotal[,i], 0.95)[1][[1]]
  KT500localSizeCIhigh[i]<-confidence_interval(KT500localmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_local_Size_11 <- KT500localSizeCIlow
CI_high_KT500_local_Size_11 <- KT500localSizeCIhigh
ave_KT500_local_Size_11 <- KT500localaverageSize
ave_KT500_local_infection_11 <- KT500localaverageInfection
x_axis_KT500_local_11 <- x_axis_KT500_local

#########################################################################################################################

setwd("~\\SF-neighbor-N-9-p-0.01-t-1000-K=500-time+strength+control")

KT500neighborinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT500neighborCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT500neighborSizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT500neighborSizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of Size on larvae
# 
KK <- c()
for ( i in 1:dim(KT500neighborSizelarvae)[1])
{
  if (KT500neighborSizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT500neighborSizelarvae)[1]+1)
# 

#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_1 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_1 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_infection_1 <- KT500neighboraverageInfection
ave_KT500_neighbor_Size_1 <- KT500neighboraverageSize
x_axis_KT500_neighbor_1 <- x_axis_KT500_neighbor

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_2 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_2 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_2 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_2 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_2 <- x_axis_KT500_neighbor

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_3 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_3 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_3 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_3 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_3 <- x_axis_KT500_neighbor

###################################################################

##level 4

###################################################################


i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_4 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_4 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_4 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_4 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_4 <- x_axis_KT500_neighbor

################################################################

## level 5

################################################################


i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_5 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_5 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_5 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_5 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_5 <- x_axis_KT500_neighbor


####################################################################

##level 6

###################################################################


i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_6 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_6 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_6 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_6 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_6 <- x_axis_KT500_neighbor

##############################################################

# ## level 7
#
# #############################################################


i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1
 
}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_7 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_7 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_7 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_7 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_7 <- x_axis_KT500_neighbor

# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_8 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_8 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_8 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_8 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_8 <- x_axis_KT500_neighbor

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1
}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_9 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_9 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_9 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_9 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_9 <- x_axis_KT500_neighbor

# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1
}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_10 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_10 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_10 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_10 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_10 <- x_axis_KT500_neighbor

############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500neighborinfect <- KT500neighborinfection[ind[1]:(ind[length(ind)]-1), ]

KT500neighboradultSize <- KT500neighborSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500neighborlarvaeSize <- KT500neighborSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500neighborCIdistancenew <- KT500neighborCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500neighboradultSize)[1])
{
  if (KT500neighboradultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500neighboradultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500neighbormeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500neighbormeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_neighbor <- KT500neighboradultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_neighbor <-KT500neighboradultSize[KK[rep]:dim(KT500neighboradultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500neighbordataset0 <- KT500neighborinfect[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordataset2 <- KT500neighboradultSize[KK[i]:(KK[i+1]-1),]
  KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[i,])+1)]
  KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
  KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
  KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y
  
  KT500neighbormeanInfectiontotal[i,]<-KT500neighbormeanInfectionSum
  KT500neighbormeanSizetotal[i,]<-KT500neighbormeanSizesum1

}

##last row of KT500neighbormeanadultSize
KT500neighbordataset0 <- KT500neighborinfect[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset1 <- KT500neighborlarvaeSize[KK[rep]:attributes(as.matrix(KT500neighborlarvaeSize))$dim[1],]
KT500neighbordataset2 <- KT500neighboradultSize[KK[rep]:attributes(as.matrix(KT500neighboradultSize))$dim[1],]
KT500neighbordata0 <- KT500neighbordataset0[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize1 <- KT500neighbordataset1[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 

KT500neighbordataSize2 <- KT500neighbordataset2[,-(which.min(KT500neighborCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500neighbormeanInfectionSum <- as.vector(rowSums(KT500neighbordata0[,2:ncol(KT500neighbordata0)])/(N-1))
KT500neighbormeanSizesum <- as.vector(rowSums(1*KT500neighbordataSize1[,2:ncol(KT500neighbordataSize1)]+1*KT500neighbordataSize2[,2:ncol(KT500neighbordataSize2)])/(N-1))
KT500neighbormeanSizesum1<-approx(KT500neighbordataSize1[,1],KT500neighbormeanSizesum, x_axis_KT500_neighbor)$y

KT500neighbormeanInfectiontotal[rep,]<-KT500neighbormeanInfectionSum
KT500neighbormeanSizetotal[rep,]<-KT500neighbormeanSizesum1

KT500neighboraverageInfection <- colSums(KT500neighbormeanInfectiontotal)/rep

KT500neighboraverageSize <- colSums(KT500neighbormeanSizetotal)/rep

KT500neighborSizeCIlow<-c()
KT500neighborSizeCIhigh<-c()

for(i in 1:length(KT500neighboraverageSize))
{
  KT500neighborSizeCIlow[i]<-confidence_interval(KT500neighbormeanSizetotal[,i], 0.95)[1][[1]]
  KT500neighborSizeCIhigh[i]<-confidence_interval(KT500neighbormeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_neighbor_Size_11 <- KT500neighborSizeCIlow
CI_high_KT500_neighbor_Size_11 <- KT500neighborSizeCIhigh
ave_KT500_neighbor_Size_11 <- KT500neighboraverageSize
ave_KT500_neighbor_infection_11 <- KT500neighboraverageInfection
x_axis_KT500_neighbor_11 <- x_axis_KT500_neighbor

##################################################################################################################################
setwd("~\\SF-global-N-9-p-0.01-t-1000-K=500-time+strength+control")

KT500globalinfection <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-HUMANS.csv",header=FALSE,stringsAsFactors = FALSE)
KT500globalCIdistance <- read.csv("2-a1--a2--g1--g2--e1--e2--DISTANCE-PATCH.csv",header = FALSE)
KT500globalSizelarvae <- read.csv("2-a1--a2--g1--g2--e1--e2--MOSQUITOES-LARVAE.csv",header=FALSE)
KT500globalSizeadult <- read.csv("2-a1--a2--g1--g2--e1--e2--INFECTED-MOSQUITOES.csv", header=FALSE)


#############################################################

# group all orginal datasets according to the levels of Size on larvae
# 
KK <- c()
for ( i in 1:dim(KT500globalSizelarvae)[1])
{
  if (KT500globalSizelarvae[i,1] == 0)
    KK <- c(KK, i)
}

KK_new <- c(KK, dim(KT500globalSizelarvae)[1]+1)

#################################################################

##level 1

################################################################

i = 1

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1
 
}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_1 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_1 <- KT500globalSizeCIhigh
ave_KT500_global_infection_1 <- KT500globalaverageInfection
ave_KT500_global_Size_1 <- KT500globalaverageSize
x_axis_KT500_global_1 <- x_axis_KT500_global

#####################################################

# for level 2

#####################################################

i = 2

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1

}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_2 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_2 <- KT500globalSizeCIhigh
ave_KT500_global_Size_2 <- KT500globalaverageSize
ave_KT500_global_infection_2 <- KT500globalaverageInfection
x_axis_KT500_global_2 <- x_axis_KT500_global

########################################################

##level 3

########################################################

i = 3

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1
}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_3 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_3 <- KT500globalSizeCIhigh
ave_KT500_global_Size_3 <- KT500globalaverageSize
ave_KT500_global_infection_3 <- KT500globalaverageInfection
x_axis_KT500_global_3 <- x_axis_KT500_global


###################################################################

##level 4

###################################################################


i = 4

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1
 
}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_4 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_4 <- KT500globalSizeCIhigh
ave_KT500_global_Size_4 <- KT500globalaverageSize
ave_KT500_global_infection_4 <- KT500globalaverageInfection
x_axis_KT500_global_4 <- x_axis_KT500_global


################################################################

## level 5

################################################################


i = 5

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1

}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_5 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_5 <- KT500globalSizeCIhigh
ave_KT500_global_Size_5 <- KT500globalaverageSize
ave_KT500_global_infection_5 <- KT500globalaverageInfection
x_axis_KT500_global_5 <- x_axis_KT500_global


####################################################################

##level 6

###################################################################


i = 6

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1

}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_6 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_6 <- KT500globalSizeCIhigh
ave_KT500_global_Size_6 <- KT500globalaverageSize
ave_KT500_global_infection_6 <- KT500globalaverageInfection
x_axis_KT500_global_6 <- x_axis_KT500_global


##############################################################

# ## level 7
#
# #############################################################


i = 7

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1

}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_7 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_7 <- KT500globalSizeCIhigh
ave_KT500_global_Size_7 <- KT500globalaverageSize
ave_KT500_global_infection_7 <- KT500globalaverageInfection
x_axis_KT500_global_7 <- x_axis_KT500_global


# ############################################################
#
# ##level 8
#
# ############################################################

i = 8

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1
}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_8 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_8 <- KT500globalSizeCIhigh
ave_KT500_global_Size_8 <- KT500globalaverageSize
ave_KT500_global_infection_8 <- KT500globalaverageInfection
x_axis_KT500_global_8 <- x_axis_KT500_global

# ############################################################
#
# ##level 9
#
# ############################################################

i = 9

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1
}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_9 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_9 <- KT500globalSizeCIhigh
ave_KT500_global_Size_9 <- KT500globalaverageSize
ave_KT500_global_infection_9 <- KT500globalaverageInfection
x_axis_KT500_global_9 <- x_axis_KT500_global


# ###########################################################
#
# ##level 10
#
# ############################################################

i = 10

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1

}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_10 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_10 <- KT500globalSizeCIhigh
ave_KT500_global_Size_10 <- KT500globalaverageSize
ave_KT500_global_infection_10 <- KT500globalaverageInfection
x_axis_KT500_global_10 <- x_axis_KT500_global


############################################################

##level 11

############################################################

i = 11

epsilon <- c(cont[i]+0.0001, 200.0001-cont[i])

ind <- KK_new[(replic * (i - 1) + 1) : (replic * i + 1)]


KT500globalinfect <- KT500globalinfection[ind[1]:(ind[length(ind)]-1), ]

KT500globaladultSize <- KT500globalSizeadult[ind[1]:(ind[length(ind)]-1), ]

KT500globallarvaeSize <- KT500globalSizelarvae[ind[1]:(ind[length(ind)]-1), ]

KT500globalCIdistancenew <- KT500globalCIdistance[(replic * (i - 1) + 1): (replic * i),]


KK<-c()
for ( i in 1:dim(KT500globaladultSize)[1])
{
  if (KT500globaladultSize[i,1]==0)
    KK <-c(KK, i)
}

lastlength <- dim(KT500globaladultSize)[1]-KK[length(KK)]+1
diff <- c(diff(KK), lastlength)

KT500globalmeanInfectiontotal<-matrix(, nrow = rep, ncol = max(diff))
KT500globalmeanSizetotal<-matrix(, nrow = rep, ncol = max(diff))

index <- which.max(diff)

if(index < rep)
{
  x_axis_KT500_global <- KT500globaladultSize[KK[index]:(KK[index+1]-1),1]
} else
{
  x_axis_KT500_global <-KT500globaladultSize[KK[rep]:dim(KT500globaladultSize)[1],1]
}


for (i in 1:(rep-1))
{
  
  KT500globaldataset0 <- KT500globalinfect[KK[i]:(KK[i+1]-1),]
  KT500globaldataset1 <- KT500globallarvaeSize[KK[i]:(KK[i+1]-1),]
  KT500globaldataset2 <- KT500globaladultSize[KK[i]:(KK[i+1]-1),]
  KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[i,])+1)]
  KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[i,])+1)] 
  ##this 1 is the time column
  KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
  KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
  KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y
  
  KT500globalmeanInfectiontotal[i,]<-KT500globalmeanInfectionSum
  KT500globalmeanSizetotal[i,]<-KT500globalmeanSizesum1

}

##last row of KT500globalmeanadultSize
KT500globaldataset0 <- KT500globalinfect[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset1 <- KT500globallarvaeSize[KK[rep]:attributes(as.matrix(KT500globallarvaeSize))$dim[1],]
KT500globaldataset2 <- KT500globaladultSize[KK[rep]:attributes(as.matrix(KT500globaladultSize))$dim[1],]
KT500globaldata0 <- KT500globaldataset0[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize1 <- KT500globaldataset1[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 

KT500globaldataSize2 <- KT500globaldataset2[,-(which.min(KT500globalCIdistancenew[rep,])+1)] 
##this 1 is the time column
KT500globalmeanInfectionSum <- as.vector(rowSums(KT500globaldata0[,2:ncol(KT500globaldata0)])/(N-1))
KT500globalmeanSizesum <- as.vector(rowSums(1*KT500globaldataSize1[,2:ncol(KT500globaldataSize1)]+1*KT500globaldataSize2[,2:ncol(KT500globaldataSize2)])/(N-1))
KT500globalmeanSizesum1<-approx(KT500globaldataSize1[,1],KT500globalmeanSizesum, x_axis_KT500_global)$y

KT500globalmeanInfectiontotal[rep,]<-KT500globalmeanInfectionSum
KT500globalmeanSizetotal[rep,]<-KT500globalmeanSizesum1

KT500globalaverageInfection <- colSums(KT500globalmeanInfectiontotal)/rep

KT500globalaverageSize <- colSums(KT500globalmeanSizetotal)/rep

KT500globalSizeCIlow<-c()
KT500globalSizeCIhigh<-c()

for(i in 1:length(KT500globalaverageSize))
{
  KT500globalSizeCIlow[i]<-confidence_interval(KT500globalmeanSizetotal[,i], 0.95)[1][[1]]
  KT500globalSizeCIhigh[i]<-confidence_interval(KT500globalmeanSizetotal[,i],0.95)[2][[1]]
}

## assign the level

CI_low_KT500_global_Size_11 <- KT500globalSizeCIlow
CI_high_KT500_global_Size_11 <- KT500globalSizeCIhigh
ave_KT500_global_Size_11 <- KT500globalaverageSize
ave_KT500_global_infection_11 <- KT500globalaverageInfection
x_axis_KT500_global_11 <- x_axis_KT500_global

####################################################################################################################################

middle <- 601
####Fine the middle point at time 150
ave_KT500_local_Size_middle <- c(ave_KT500_local_Size_1[middle], ave_KT500_local_Size_2[middle], ave_KT500_local_Size_3[middle], ave_KT500_local_Size_4[middle], ave_KT500_local_Size_5[middle], ave_KT500_local_Size_6[middle], ave_KT500_local_Size_7[middle], ave_KT500_local_Size_8[middle], ave_KT500_local_Size_9[middle], ave_KT500_local_Size_10[middle], ave_KT500_local_Size_11[middle])

CIlow_KT500_local_Size_middle <- c(CI_low_KT500_local_Size_1[middle], CI_low_KT500_local_Size_2[middle], CI_low_KT500_local_Size_3[middle], CI_low_KT500_local_Size_4[middle], CI_low_KT500_local_Size_5[middle], CI_low_KT500_local_Size_6[middle], CI_low_KT500_local_Size_7[middle], CI_low_KT500_local_Size_8[middle], CI_low_KT500_local_Size_9[middle], CI_low_KT500_local_Size_10[middle], CI_low_KT500_local_Size_11[middle])

CIhigh_KT500_local_Size_middle <- c(CI_high_KT500_local_Size_1[middle], CI_high_KT500_local_Size_2[middle], CI_high_KT500_local_Size_3[middle], CI_high_KT500_local_Size_4[middle], CI_high_KT500_local_Size_5[middle], CI_high_KT500_local_Size_6[middle], CI_high_KT500_local_Size_7[middle], CI_high_KT500_local_Size_8[middle], CI_high_KT500_local_Size_9[middle], CI_high_KT500_local_Size_10[middle], CI_high_KT500_local_Size_11[middle]) 

ave_KT500_neighbor_Size_middle <- c(ave_KT500_neighbor_Size_1[middle], ave_KT500_neighbor_Size_2[middle], ave_KT500_neighbor_Size_3[middle], ave_KT500_neighbor_Size_4[middle], ave_KT500_neighbor_Size_5[middle], ave_KT500_neighbor_Size_6[middle], ave_KT500_neighbor_Size_7[middle], ave_KT500_neighbor_Size_8[middle], ave_KT500_neighbor_Size_9[middle], ave_KT500_neighbor_Size_10[middle], ave_KT500_neighbor_Size_11[middle])


CIlow_KT500_neighbor_Size_middle <- c(CI_low_KT500_neighbor_Size_1[middle], CI_low_KT500_neighbor_Size_2[middle], CI_low_KT500_neighbor_Size_3[middle], CI_low_KT500_neighbor_Size_4[middle], CI_low_KT500_neighbor_Size_5[middle], CI_low_KT500_neighbor_Size_6[middle], CI_low_KT500_neighbor_Size_7[middle], CI_low_KT500_neighbor_Size_8[middle], CI_low_KT500_neighbor_Size_9[middle], CI_low_KT500_neighbor_Size_10[middle], CI_low_KT500_neighbor_Size_11[middle])

CIhigh_KT500_neighbor_Size_middle <- c(CI_high_KT500_neighbor_Size_1[middle], CI_high_KT500_neighbor_Size_2[middle], CI_high_KT500_neighbor_Size_3[middle], CI_high_KT500_neighbor_Size_4[middle], CI_high_KT500_neighbor_Size_5[middle], CI_high_KT500_neighbor_Size_6[middle], CI_high_KT500_neighbor_Size_7[middle], CI_high_KT500_neighbor_Size_8[middle], CI_high_KT500_neighbor_Size_9[middle], CI_high_KT500_neighbor_Size_10[middle], CI_high_KT500_neighbor_Size_11[middle]) 


####Fine the middle point at time 150
ave_KT500_global_Size_middle <- c(ave_KT500_global_Size_1[middle], ave_KT500_global_Size_2[middle], ave_KT500_global_Size_3[middle], ave_KT500_global_Size_4[middle], ave_KT500_global_Size_5[middle], ave_KT500_global_Size_6[middle], ave_KT500_global_Size_7[middle], ave_KT500_global_Size_8[middle], ave_KT500_global_Size_9[middle], ave_KT500_global_Size_10[middle], ave_KT500_global_Size_11[middle])

CIlow_KT500_global_Size_middle <- c(CI_low_KT500_global_Size_1[middle], CI_low_KT500_global_Size_2[middle], CI_low_KT500_global_Size_3[middle], CI_low_KT500_global_Size_4[middle], CI_low_KT500_global_Size_5[middle], CI_low_KT500_global_Size_6[middle], CI_low_KT500_global_Size_7[middle], CI_low_KT500_global_Size_8[middle], CI_low_KT500_global_Size_9[middle], CI_low_KT500_global_Size_10[middle], CI_low_KT500_global_Size_11[middle])

CIhigh_KT500_global_Size_middle <- c(CI_high_KT500_global_Size_1[middle], CI_high_KT500_global_Size_2[middle], CI_high_KT500_global_Size_3[middle], CI_high_KT500_global_Size_4[middle], CI_high_KT500_global_Size_5[middle], CI_high_KT500_global_Size_6[middle], CI_high_KT500_global_Size_7[middle], CI_high_KT500_global_Size_8[middle], CI_high_KT500_global_Size_9[middle], CI_high_KT500_global_Size_10[middle], CI_high_KT500_global_Size_11[middle]) 


####Fine the middle point at time 150
ave_KT800_local_Size_middle <- c(ave_KT800_local_Size_1[middle], ave_KT800_local_Size_2[middle], ave_KT800_local_Size_3[middle], ave_KT800_local_Size_4[middle], ave_KT800_local_Size_5[middle], ave_KT800_local_Size_6[middle], ave_KT800_local_Size_7[middle], ave_KT800_local_Size_8[middle], ave_KT800_local_Size_9[middle], ave_KT800_local_Size_10[middle], ave_KT800_local_Size_11[middle])

CIlow_KT800_local_Size_middle <- c(CI_low_KT800_local_Size_1[middle], CI_low_KT800_local_Size_2[middle], CI_low_KT800_local_Size_3[middle], CI_low_KT800_local_Size_4[middle], CI_low_KT800_local_Size_5[middle], CI_low_KT800_local_Size_6[middle], CI_low_KT800_local_Size_7[middle], CI_low_KT800_local_Size_8[middle], CI_low_KT800_local_Size_9[middle], CI_low_KT800_local_Size_10[middle], CI_low_KT800_local_Size_11[middle])

CIhigh_KT800_local_Size_middle <- c(CI_high_KT800_local_Size_1[middle], CI_high_KT800_local_Size_2[middle], CI_high_KT800_local_Size_3[middle], CI_high_KT800_local_Size_4[middle], CI_high_KT800_local_Size_5[middle], CI_high_KT800_local_Size_6[middle], CI_high_KT800_local_Size_7[middle], CI_high_KT800_local_Size_8[middle], CI_high_KT800_local_Size_9[middle], CI_high_KT800_local_Size_10[middle], CI_high_KT800_local_Size_11[middle]) 


####Fine the middle point at time 150
ave_KT800_neighbor_Size_middle <- c(ave_KT800_neighbor_Size_1[middle], ave_KT800_neighbor_Size_2[middle], ave_KT800_neighbor_Size_3[middle], ave_KT800_neighbor_Size_4[middle], ave_KT800_neighbor_Size_5[middle], ave_KT800_neighbor_Size_6[middle], ave_KT800_neighbor_Size_7[middle], ave_KT800_neighbor_Size_8[middle], ave_KT800_neighbor_Size_9[middle], ave_KT800_neighbor_Size_10[middle], ave_KT800_neighbor_Size_11[middle])

CIlow_KT800_neighbor_Size_middle <- c(CI_low_KT800_neighbor_Size_1[middle], CI_low_KT800_neighbor_Size_2[middle], CI_low_KT800_neighbor_Size_3[middle], CI_low_KT800_neighbor_Size_4[middle], CI_low_KT800_neighbor_Size_5[middle], CI_low_KT800_neighbor_Size_6[middle], CI_low_KT800_neighbor_Size_7[middle], CI_low_KT800_neighbor_Size_8[middle], CI_low_KT800_neighbor_Size_9[middle], CI_low_KT800_neighbor_Size_10[middle], CI_low_KT800_neighbor_Size_11[middle])

CIhigh_KT800_neighbor_Size_middle <- c(CI_high_KT800_neighbor_Size_1[middle], CI_high_KT800_neighbor_Size_2[middle], CI_high_KT800_neighbor_Size_3[middle], CI_high_KT800_neighbor_Size_4[middle], CI_high_KT800_neighbor_Size_5[middle], CI_high_KT800_neighbor_Size_6[middle], CI_high_KT800_neighbor_Size_7[middle], CI_high_KT800_neighbor_Size_8[middle], CI_high_KT800_neighbor_Size_9[middle], CI_high_KT800_neighbor_Size_10[middle], CI_high_KT800_neighbor_Size_11[middle]) 


####Fine the middle point at time 150
ave_KT800_global_Size_middle <- c(ave_KT800_global_Size_1[middle], ave_KT800_global_Size_2[middle], ave_KT800_global_Size_3[middle], ave_KT800_global_Size_4[middle], ave_KT800_global_Size_5[middle], ave_KT800_global_Size_6[middle], ave_KT800_global_Size_7[middle], ave_KT800_global_Size_8[middle], ave_KT800_global_Size_9[middle], ave_KT800_global_Size_10[middle], ave_KT800_global_Size_11[middle])

CIlow_KT800_global_Size_middle <- c(CI_low_KT800_global_Size_1[middle], CI_low_KT800_global_Size_2[middle], CI_low_KT800_global_Size_3[middle], CI_low_KT800_global_Size_4[middle], CI_low_KT800_global_Size_5[middle], CI_low_KT800_global_Size_6[middle], CI_low_KT800_global_Size_7[middle], CI_low_KT800_global_Size_8[middle], CI_low_KT800_global_Size_9[middle], CI_low_KT800_global_Size_10[middle], CI_low_KT800_global_Size_11[middle])

CIhigh_KT800_global_Size_middle <- c(CI_high_KT800_global_Size_1[middle], CI_high_KT800_global_Size_2[middle], CI_high_KT800_global_Size_3[middle], CI_high_KT800_global_Size_4[middle], CI_high_KT800_global_Size_5[middle], CI_high_KT800_global_Size_6[middle], CI_high_KT800_global_Size_7[middle], CI_high_KT800_global_Size_8[middle], CI_high_KT800_global_Size_9[middle], CI_high_KT800_global_Size_10[middle], CI_high_KT800_global_Size_11[middle]) 

####Fine the middle point at time 150
ave_KT2000_local_Size_middle <- c(ave_KT2000_local_size_1[middle], ave_KT2000_local_size_2[middle], ave_KT2000_local_size_3[middle], ave_KT2000_local_size_4[middle], ave_KT2000_local_size_5[middle], ave_KT2000_local_size_6[middle], ave_KT2000_local_size_7[middle], ave_KT2000_local_size_8[middle], ave_KT2000_local_size_9[middle], ave_KT2000_local_size_10[middle], ave_KT2000_local_size_11[middle])

CIlow_KT2000_local_size_middle <- c(CI_low_KT2000_local_size_1[middle], CI_low_KT2000_local_size_2[middle], CI_low_KT2000_local_size_3[middle], CI_low_KT2000_local_size_4[middle], CI_low_KT2000_local_size_5[middle], CI_low_KT2000_local_size_6[middle], CI_low_KT2000_local_size_7[middle], CI_low_KT2000_local_size_8[middle], CI_low_KT2000_local_size_9[middle], CI_low_KT2000_local_size_10[middle], CI_low_KT2000_local_size_11[middle])

CIhigh_KT2000_local_size_middle <- c(CI_high_KT2000_local_size_1[middle], CI_high_KT2000_local_size_2[middle], CI_high_KT2000_local_size_3[middle], CI_high_KT2000_local_size_4[middle], CI_high_KT2000_local_size_5[middle], CI_high_KT2000_local_size_6[middle], CI_high_KT2000_local_size_7[middle], CI_high_KT2000_local_size_8[middle], CI_high_KT2000_local_size_9[middle], CI_high_KT2000_local_size_10[middle], CI_high_KT2000_local_size_11[middle]) 


####Fine the middle point at time 150
ave_KT2000_neighbor_size_middle <- c(ave_KT2000_neighbor_size_1[middle], ave_KT2000_neighbor_size_2[middle], ave_KT2000_neighbor_size_3[middle], ave_KT2000_neighbor_size_4[middle], ave_KT2000_neighbor_size_5[middle], ave_KT2000_neighbor_size_6[middle], ave_KT2000_neighbor_size_7[middle], ave_KT2000_neighbor_size_8[middle], ave_KT2000_neighbor_size_9[middle], ave_KT2000_neighbor_size_10[middle], ave_KT2000_neighbor_size_11[middle])

CIlow_KT2000_neighbor_size_middle <- c(CI_low_KT2000_neighbor_size_1[middle], CI_low_KT2000_neighbor_size_2[middle], CI_low_KT2000_neighbor_size_3[middle], CI_low_KT2000_neighbor_size_4[middle], CI_low_KT2000_neighbor_size_5[middle], CI_low_KT2000_neighbor_size_6[middle], CI_low_KT2000_neighbor_size_7[middle], CI_low_KT2000_neighbor_size_8[middle], CI_low_KT2000_neighbor_size_9[middle], CI_low_KT2000_neighbor_size_10[middle], CI_low_KT2000_neighbor_size_11[middle])

CIhigh_KT2000_neighbor_size_middle <- c(CI_high_KT2000_neighbor_size_1[middle], CI_high_KT2000_neighbor_size_2[middle], CI_high_KT2000_neighbor_size_3[middle], CI_high_KT2000_neighbor_size_4[middle], CI_high_KT2000_neighbor_size_5[middle], CI_high_KT2000_neighbor_size_6[middle], CI_high_KT2000_neighbor_size_7[middle], CI_high_KT2000_neighbor_size_8[middle], CI_high_KT2000_neighbor_size_9[middle], CI_high_KT2000_neighbor_size_10[middle], CI_high_KT2000_neighbor_size_11[middle]) 


####Fine the middle point at time 150
ave_KT2000_global_size_middle <- c(ave_KT2000_global_size_1[middle], ave_KT2000_global_size_2[middle], ave_KT2000_global_size_3[middle], ave_KT2000_global_size_4[middle], ave_KT2000_global_size_5[middle], ave_KT2000_global_size_6[middle], ave_KT2000_global_size_7[middle], ave_KT2000_global_size_8[middle], ave_KT2000_global_size_9[middle], ave_KT2000_global_size_10[middle], ave_KT2000_global_size_11[middle])

CIlow_KT2000_global_size_middle <- c(CI_low_KT2000_global_size_1[middle], CI_low_KT2000_global_size_2[middle], CI_low_KT2000_global_size_3[middle], CI_low_KT2000_global_size_4[middle], CI_low_KT2000_global_size_5[middle], CI_low_KT2000_global_size_6[middle], CI_low_KT2000_global_size_7[middle], CI_low_KT2000_global_size_8[middle], CI_low_KT2000_global_size_9[middle], CI_low_KT2000_global_size_10[middle], CI_low_KT2000_global_size_11[middle])

CIhigh_KT2000_global_size_middle <- c(CI_high_KT2000_global_size_1[middle], CI_high_KT2000_global_size_2[middle], CI_high_KT2000_global_size_3[middle], CI_high_KT2000_global_size_4[middle], CI_high_KT2000_global_size_5[middle], CI_high_KT2000_global_size_6[middle], CI_high_KT2000_global_size_7[middle], CI_high_KT2000_global_size_8[middle], CI_high_KT2000_global_size_9[middle], CI_high_KT2000_global_size_10[middle], CI_high_KT2000_global_size_11[middle]) 


###################################################################################################
jpeg("Figure_S2.jpeg", width=10,height=10, units='in',res=600)

par(mfrow=c(3,1))
par(mar=c(2,3,3,3))


plot(cont, ave_KT500_local_Size_middle, type = "o", lwd = 2, xlab = "Levels of Adult Concern", ylab = "Total Size at time 300",col="red", ylim = c(min(ave_KT500_local_Size_middle), max(ave_KT500_local_Size_middle)))
points(cont, ave_KT500_neighbor_Size_middle, type = "o", col = "blue")
points(cont, ave_KT500_global_Size_middle, type = "o", col = "green")

plot(cont, ave_KT800_local_Size_middle, type = "o", lwd = 2, xlab = "Levels of Adult Concern", ylab = "Total Size at time 300",col="red", ylim = c(min(ave_KT800_local_Size_middle), max(ave_KT800_local_Size_middle)))
points(cont, ave_KT800_neighbor_Size_middle, type = "o", col = "blue")
points(cont, ave_KT800_global_Size_middle, type = "o", col = "green")

plot(cont, ave_KT2000_local_Size_middle, type = "o", lwd = 2, xlab = "Levels of Adult Concern", ylab = "Total Size at time 300",col="red", ylim = c(min(ave_KT2000_local_Size_middle), max(ave_KT2000_local_Size_middle)))
points(cont, ave_KT2000_neighbor_size_middle, type = "o", col = "blue")
points(cont, ave_KT2000_global_Size_middle, type = "o", col = "green")

dev.off()


